import os
import subprocess
import sys

all_datasets_folder=sys.argv[1]###All the datasets folder
cleanup_folder=sys.argv[2]###To store the selected dataset


all_datasets=os.listdir(all_datasets_folder)
datasets_selected_paths=[]

# Ankit to  be tested
empty_prog_list = open("empty_prog_list","w")
i=0

for dataset_folder in all_datasets:
    datasets=os.listdir(all_datasets_folder+"/"+dataset_folder)
    path = all_datasets_folder+"/"+dataset_folder+"/"

    for dataset in datasets:
        file_name = dataset.split("_")
        merged_file_name = file_name[0] + "_" + file_name[1] + "_merged.pcap"
        cmdline="mergecap -w " +  path + merged_file_name + " " + path + file_name[0] + "_" + file_name[1] + "*"
        print (cmdline)
        os.system(cmdline)

        mv_cmdline="mv " + path + merged_file_name + " " + "./" + cleanup_folder + "/"
        os.system(mv_cmdline)
        break;


